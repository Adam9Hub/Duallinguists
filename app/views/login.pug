extends layout

block content
  h1 Login
  form(action='/login', method='POST', onsubmit="storeUserID(event)")
    label(for='email') Email:
    input(type='email', name='email', required)

    label(for='password') Password:
    input(type='password', name='password', required)

    button(type='submit') Log In
    p Don't have an account? 
      a(href='/signup') Sign up here

  script.
      function storeUserID(event) {
          event.preventDefault(); // Prevent default form submission

          const form = event.target;
          fetch(form.action, {
              method: form.method,
              headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
              body: new URLSearchParams(new FormData(form))
          })
          .then(response => {
              if (response.redirected) {
                  window.location.href = response.url; // Handle redirect properly
              } else {
                  return response.text().then(text => { throw new Error(text); });
              }
          })
          .catch(error => alert("Login failed: " + error.message));
      }